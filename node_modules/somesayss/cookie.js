/**
 * @fileoverview cookie
 * @param {object} request 请求
 * @param {object} response 响应
 */
var $ = require('somesayss'),
	querystring = require('querystring').parse;

var cookie = function(request, response){
	return this instanceof cookie ? this.init(request, response) : new cookie(request, response);
}
cookie.prototype = {
	init:function(request, response){
		this.request = request;
		this.response = response;
		return this;
	},
	set: function(name, value){
		var self = this, i, temp, cookieArr = [];
		//如果没有cookieArr就新建一个
		//如果name为Object就格式化存入数组
		if($.Typeof(name) === 'Object'){
			for(i in name)
				cookieArr.push(i + '=' + encodeURIComponent(name[i]));
		}else{
			cookieArr.push(name + '=' + encodeURIComponent(value));
		}
		self.response.setHeader("Set-Cookie", cookieArr);
		return self;
	},
	get: function(name){
		var key = querystring(this.request.headers['cookie'], sep='; ', eq='=')[name];
		return key === undefined ? undefined : decodeURIComponent(key);
	}
}
exports.cookie = cookie;